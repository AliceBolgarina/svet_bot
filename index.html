<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–í—ã–±–æ—Ä –ø—É–Ω–∫—Ç–∞ –≤—ã–¥–∞—á–∏ - –†–∞—Å—Å–µ—è–Ω–Ω—ã–π —Å–≤–µ—Ç</title>
    <script async src="https://ndd-widget.landpro.site/widget.js"></script>
    <style>
        /* –°—Ç–∏–ª–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üó∫Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç –≤—ã–¥–∞—á–∏ (–†–ï–ñ–ò–ú –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø)</h1>
            <p>–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ç–∞–Ω—Ü–∏—è –Ø–Ω–¥–µ–∫—Å.–î–æ—Å—Ç–∞–≤–∫–∏</p>
        </div>
        
        <div class="instruction">
            <strong>–í–ù–ò–ú–ê–ù–ò–ï: –†–µ–∂–∏–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</strong>
            <p>–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ç–∞–Ω—Ü–∏—è –æ—Ç–≥—Ä—É–∑–∫–∏ –Ø–Ω–¥–µ–∫—Å.</p>
            <p>–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞ –≤ –Ø–Ω–¥–µ–∫—Å.–î–æ—Å—Ç–∞–≤–∫–µ –∑–∞–º–µ–Ω–∏—Ç–µ ID —Å—Ç–∞–Ω—Ü–∏–∏ –Ω–∞ –≤–∞—à.</p>
        </div>
        
        <div class="widget-container">
            <div class="loading" id="loadingWidget">
                –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ—Å—Ç–æ–≤—É—é –∫–∞—Ä—Ç—É –ø—É–Ω–∫—Ç–æ–≤ –≤—ã–¥–∞—á–∏...
            </div>
            <div id="delivery-widget" style="display: none;"></div>
        </div>
    </div>
    
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–∏–¥–∂–µ—Ç–∞ —Å –¢–ï–°–¢–û–í–´–ú ID
        (function(w) {
            function startWidget() {
                document.getElementById('loadingWidget').style.display = 'none';
                document.getElementById('delivery-widget').style.display = 'block';
                
                // –¢–ï–°–¢–û–í–´–ô ID –°–¢–ê–ù–¶–ò–ò –û–¢–ì–†–£–ó–ö–ò
                const TEST_STATION_ID = "05e809bb-4521-42d9-a936-0fb0744c0fb3";
                
                w.YaDelivery.createWidget({
                    containerId: 'delivery-widget',
                    params: {
                        city: "–ú–æ—Å–∫–≤–∞",
                        size: {
                            "height": "500px",
                            "width": "100%"
                        },
                        source_platform_station: TEST_STATION_ID, // –¢–µ—Å—Ç–æ–≤—ã–π ID
                        physical_dims_weight_gross: 2000,
                        delivery_price: "300 —Ä—É–±. (—Ç–µ—Å—Ç)", 
                        delivery_term: "2-4 –¥–Ω—è (—Ç–µ—Å—Ç)",
                        show_select_button: true,
                        filter: {
                            type: ["pickup_point", "terminal"],
                            is_yandex_branded: false,
                            payment_methods: ["already_paid", "card_on_receipt"],
                            payment_methods_filter: "or"
                        }
                    },
                });
            }
            
            w.YaDelivery
                ? startWidget()
                : document.addEventListener('YaNddWidgetLoad', startWidget);
        })(window);
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –ü–í–ó (–æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        let selectedPVZ = null;
        
        document.addEventListener('YaNddWidgetPointSelected', function (data) {
            selectedPVZ = data.detail;
            console.log('–¢–µ—Å—Ç–æ–≤—ã–π –ü–í–ó –≤—ã–±—Ä–∞–Ω:', selectedPVZ);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
            const confirmBtn = document.createElement('button');
            confirmBtn.id = 'confirmBtn';
            confirmBtn.className = 'confirm-btn show';
            confirmBtn.innerHTML = '‚úÖ –¢–µ—Å—Ç: –û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ü–í–ó';
            confirmBtn.onclick = sendTestData;
            
            document.querySelector('.container').appendChild(confirmBtn);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º –ü–í–ó
            const infoDiv = document.createElement('div');
            infoDiv.className = 'selected-info show';
            infoDiv.innerHTML = `
                <div class="pvz-name">üìç ${selectedPVZ.name || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</div>
                <div class="pvz-address">üè† ${selectedPVZ.address.full_address}</div>
                <div>üÜî ID: ${selectedPVZ.id}</div>
            `;
            
            document.querySelector('.container').appendChild(infoDiv);
        });
        
        function sendTestData() {
            if (!selectedPVZ) return;
            
            const pvzData = {
                action: 'pvz_selected',
                pvz_id: selectedPVZ.id,
                pvz_name: selectedPVZ.name,
                pvz_address: selectedPVZ.address.full_address,
                pvz_city: selectedPVZ.address.locality || '',
                pvz_street: selectedPVZ.address.street || '',
                pvz_house: selectedPVZ.address.house || '',
                pvz_working_hours: selectedPVZ.working_hours || '',
                pvz_phone: selectedPVZ.phone || '',
                pvz_type: selectedPVZ.type || 'pickup_point',
                test_mode: true // –§–ª–∞–≥ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞
            };
            
            console.log('–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ü–í–ó:', pvzData);
            
            // –ï—Å–ª–∏ –≤ Telegram Web App - –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.sendData(JSON.stringify(pvzData));
                alert('–î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ Telegram! –ó–∞–∫—Ä–æ–π—Ç–µ –æ–∫–Ω–æ.');
            } else {
                // –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ
                alert('–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:\n' + JSON.stringify(pvzData, null, 2));
                console.log('–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:', pvzData);
            }
        }
        
        // –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ –¥–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É
        if (!window.Telegram) {
            document.addEventListener('DOMContentLoaded', function() {
                const testBtn = document.createElement('button');
                testBtn.innerHTML = 'üîÑ –¢–µ—Å—Ç: –ò–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—ã–±–æ—Ä –ü–í–ó';
                testBtn.style.cssText = `
                    background: #ff9800;
                    color: white;
                    border: none;
                    padding: 12px 24px;
                    border-radius: 8px;
                    margin: 20px auto;
                    display: block;
                    cursor: pointer;
                `;
                testBtn.onclick = function() {
                    // –ò–º–∏—Ç–∏—Ä—É–µ–º –≤—ã–±–æ—Ä —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ü–í–ó
                    const mockEvent = new CustomEvent('YaNddWidgetPointSelected', {
                        detail: {
                            id: 'test_pvz_123',
                            name: '–¢–µ—Å—Ç–æ–≤—ã–π –ø—É–Ω–∫—Ç –≤—ã–¥–∞—á–∏',
                            type: 'pickup_point',
                            address: {
                                full_address: '–ú–æ—Å–∫–≤–∞, —É–ª. –¢–µ—Å—Ç–æ–≤–∞—è, –¥. 1',
                                locality: '–ú–æ—Å–∫–≤–∞',
                                street: '—É–ª. –¢–µ—Å—Ç–æ–≤–∞—è',
                                house: '–¥. 1'
                            },
                            working_hours: '09:00-21:00',
                            phone: '+7 (999) 123-45-67'
                        }
                    });
                    document.dispatchEvent(mockEvent);
                };
                
                document.querySelector('.container').appendChild(testBtn);
            });
        }
    </script>
</body>
</html>
